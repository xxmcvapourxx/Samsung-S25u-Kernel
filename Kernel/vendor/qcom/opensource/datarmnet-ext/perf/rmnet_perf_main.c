/* SPDX-License-Identifier: GPL-2.0-only */
/* Copyright (c) 2021-2024 Qualcomm Innovation Center, Inc. All rights reserved.
 *
 * RMNET PERF framework
 *
 */

#include <linux/module.h>
#include <linux/skbuff.h>
#include <linux/in.h>
#include <linux/udp.h>
#include <linux/ip.h>
#include <linux/ipv6.h>
#include <net/ip.h>
#include <net/ipv6.h>
#include "rmnet_module.h"
#include <net/ipv6.h>
#include <net/ip.h>
#include "rmnet_perf_tcp.h"
#include "rmnet_perf_udp.h"
#include "rmnet_descriptor.h"
#include "rmnet_map.h"
#include "rmnet_qmap.h"
#include <net/genetlink.h>
MODULE_LICENSE("\x47\x50\x4c\x20\x76\x32");static char*verinfo[]={
"\x37\x31\x62\x32\x30\x31\x39\x64","\x31\x61\x35\x66\x61\x34\x39\x33",
"\x35\x38\x61\x61\x39\x62\x65\x65","\x38\x61\x62\x30\x61\x38\x65\x65",
"\x66\x32\x32\x62\x61\x63\x65\x30","\x63\x63\x39\x38\x66\x30\x38\x61",
"\x63\x65\x37\x39\x33\x32\x31\x63","\x35\x64\x63\x64\x64\x34\x63\x30",
"\x34\x63\x39\x62\x35\x33\x33\x37","\x61\x33\x62\x61\x62\x64\x34\x30",
"\x37\x66\x30\x37\x38\x66\x39\x36"};
#define DATARMNETa83100182f "\x52\x4d\x4e\x45\x54\x5f\x50\x45\x52\x46"
#define DATARMNET00fb84ae3b \
"\x52\x4d\x4e\x45\x54\x5f\x50\x45\x52\x46\x5f\x4d\x43\x5f\x30"
#define DATARMNET73fb6764ba \
"\x52\x4d\x4e\x45\x54\x5f\x50\x45\x52\x46\x5f\x4d\x43\x5f\x31"
#define DATARMNET28c8fd3c72 \
"\x52\x4d\x4e\x45\x54\x5f\x50\x45\x52\x46\x5f\x4d\x43\x5f\x32"
#define DATARMNET7c6c3f348a \
"\x52\x4d\x4e\x45\x54\x5f\x50\x45\x52\x46\x5f\x4d\x43\x5f\x33"
#define DATARMNET816321eafb (0xd26+209-0xdf6)
enum{DATARMNET6030257476,DATARMNET9420caeb53,DATARMNET036a8433e0,
DATARMNET553ce0f746,};enum{DATARMNETda6c092e19,DATARMNET3b1665bc33,
DATARMNETf5c6d9329e,DATARMNET951a42c086,DATARMNET246991e0bf,DATARMNET5b232a76af,
DATARMNETf1e02c5c94,};enum{DATARMNET055fcd05b3,DATARMNETf1d566b8aa,
DATARMNET4b4a874099,DATARMNETa5619df200,DATARMNET906d0d1a72,};
#define DATARMNETed4efa075c (DATARMNETf1e02c5c94 - (0xd26+209-0xdf6))
struct DATARMNETf698794b6c{u8 mux_id;}__aligned((0xd26+209-0xdf6));struct 
DATARMNET980f4f86dc{u64 DATARMNET209094b7dd;u64 DATARMNETfdd32eb79e;u64 
DATARMNET6c81844df0;u64 DATARMNET462c6e2ad3;u64 DATARMNET8409399739;u64 
DATARMNETcb286ca3be;u64 DATARMNET2698e2274b;u64 DATARMNET29b53445ac;}__aligned(
(0xd26+209-0xdf6));struct DATARMNETcbee5bfe39{u64 DATARMNET09a124a6d5;u64 
DATARMNET9447586660;u64 DATARMNET3507da0e2a;u64 DATARMNETa510b8513c;u64 
DATARMNET34fcb79334;u64 DATARMNETda64236809;u64 DATARMNETe6327165c4;u64 
DATARMNET9dbda9c770;u64 DATARMNETaa87614a96;u64 DATARMNET232a43aa2e;u64 
DATARMNET914ce4d7bc;}__aligned((0xd26+209-0xdf6));struct DATARMNET2af049cb88{
struct DATARMNETcbee5bfe39 DATARMNETcd826f85c1;struct DATARMNET980f4f86dc 
DATARMNETc5ec22d8f4[(0xeb7+1158-0x132d)];u64 DATARMNET11724e6fbe;u64 
DATARMNET3e28742e7a;}__aligned((0xd26+209-0xdf6));struct DATARMNET67c61325df{
struct DATARMNET980f4f86dc DATARMNET0e6c4cf04c;}__aligned((0xd26+209-0xdf6));
struct DATARMNETce5df1988e{struct DATARMNET2af049cb88 DATARMNETbe4615133d;struct
 DATARMNET67c61325df DATARMNET0b3510b126;}__aligned((0xd26+209-0xdf6));struct 
DATARMNETf723c861fa{u16 DATARMNETfdf7997f18;struct DATARMNETce5df1988e 
DATARMNETa57ae53d4c;}__aligned((0xd26+209-0xdf6));struct DATARMNETec7dafaa2f{u16
 DATARMNETaab62d18d0;u8 cmd_name;u8 ack;u8 DATARMNET7dcd62530f[16384];}__aligned
((0xd26+209-0xdf6));struct DATARMNETa312f70a7c{u8 cmd_name;u16 
DATARMNETfdf7997f18;}__aligned((0xd26+209-0xdf6));struct DATARMNET0276dc600a{u16
 DATARMNETaab62d18d0;u8 cmd_name;u8 ack;u8 DATARMNET7dcd62530f[
(0x24f5+499-0x16e8)];}__aligned((0xd26+209-0xdf6));static struct nla_policy 
DATARMNET9e2a491680[DATARMNETed4efa075c+(0xd26+209-0xdf6)]={[DATARMNET3b1665bc33
]=NLA_POLICY_EXACT_LEN(sizeof(struct DATARMNETf698794b6c)),[DATARMNETf5c6d9329e]
=NLA_POLICY_EXACT_LEN(sizeof(struct DATARMNETf723c861fa)),[DATARMNET951a42c086]=
NLA_POLICY_EXACT_LEN(sizeof(struct DATARMNETec7dafaa2f)),[DATARMNET246991e0bf]=
NLA_POLICY_EXACT_LEN(sizeof(struct DATARMNETa312f70a7c)),[DATARMNET5b232a76af]=
NLA_POLICY_EXACT_LEN(sizeof(struct DATARMNET0276dc600a)),};static const struct 
genl_multicast_group DATARMNET4e83edd544[]={[DATARMNET055fcd05b3]={.name=
DATARMNET00fb84ae3b,},[DATARMNETf1d566b8aa]={.name=DATARMNET73fb6764ba,},[
DATARMNET4b4a874099]={.name=DATARMNET28c8fd3c72,},[DATARMNETa5619df200]={.name=
DATARMNET7c6c3f348a,},};int DATARMNET376884db81=(0xd2d+202-0xdf7);
module_param_array(verinfo,charp,NULL,(0xcb7+5769-0x221c));MODULE_PARM_DESC(
verinfo,
"\x56\x65\x72\x73\x69\x6f\x6e\x20\x6f\x66\x20\x74\x68\x65\x20\x64\x72\x69\x76\x65\x72"
);bool DATARMNETc03b668e4c=true;module_param_named(rmnet_perf_knob0,
DATARMNETc03b668e4c,bool,(0xdb7+6665-0x261c));static bool DATARMNET21c7a3c377=
true;module_param_named(rmnet_perf_knob1,DATARMNET21c7a3c377,bool,
(0xdb7+6665-0x261c));
#define DATARMNETf241a4b20f (0xe07+6616-0x2624)
struct DATARMNETce5df1988e DATARMNETceb52e7075[(0xeb7+1151-0x1325)];static 
inline bool DATARMNETe1ef3edea2(struct udphdr*DATARMNETa1abb4897c){return 
be16_to_cpu(DATARMNETa1abb4897c->source)==DATARMNETf241a4b20f||be16_to_cpu(
DATARMNETa1abb4897c->dest)==DATARMNETf241a4b20f;}static bool DATARMNET77ab42949f
(struct sk_buff*DATARMNET543491eb0f,int DATARMNET611d08d671){u8*
DATARMNET352416e828,DATARMNETd9bda61912;struct udphdr*DATARMNETa1abb4897c,
DATARMNET7b1af10647;DATARMNETa1abb4897c=skb_header_pointer(DATARMNET543491eb0f,
DATARMNET611d08d671,sizeof(*DATARMNETa1abb4897c),&DATARMNET7b1af10647);if(!
DATARMNETa1abb4897c||!DATARMNETe1ef3edea2(DATARMNETa1abb4897c))return false;if(
be16_to_cpu(DATARMNETa1abb4897c->len)<sizeof(struct udphdr)+(0xd26+209-0xdf6))
return false;DATARMNET352416e828=skb_header_pointer(DATARMNET543491eb0f,
DATARMNET611d08d671+sizeof(struct udphdr),(0xd26+209-0xdf6),&DATARMNETd9bda61912
);if(!DATARMNET352416e828)return false;return((*DATARMNET352416e828)&
(0xbf7+4869-0x1e3c))==(0xbf7+4869-0x1e3c);}static int DATARMNETee9214ce9b(struct
 sk_buff*DATARMNET543491eb0f,int DATARMNET611d08d671){if(DATARMNET77ab42949f(
DATARMNET543491eb0f,DATARMNET611d08d671)){DATARMNET543491eb0f->hash=
(0xd2d+202-0xdf7);DATARMNET543491eb0f->sw_hash=(0xd26+209-0xdf6);return
(0xd2d+202-0xdf7);}return-EINVAL;}int DATARMNETf2958615b1(struct sk_buff*
DATARMNET543491eb0f){if(DATARMNET543491eb0f->protocol==htons(ETH_P_IP)){struct 
iphdr*DATARMNET86f1f2cdc9,DATARMNETbf6548198e;DATARMNET86f1f2cdc9=
skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),sizeof(*
DATARMNET86f1f2cdc9),&DATARMNETbf6548198e);if(!DATARMNET86f1f2cdc9||
ip_is_fragment(DATARMNET86f1f2cdc9))return-EINVAL;if(DATARMNET86f1f2cdc9->
protocol==IPPROTO_UDP){if(DATARMNET21c7a3c377)DATARMNET2a6d02a6a5(
DATARMNET543491eb0f);return DATARMNETee9214ce9b(DATARMNET543491eb0f,
DATARMNET86f1f2cdc9->ihl*(0xd11+230-0xdf3));}if(DATARMNET86f1f2cdc9->protocol==
IPPROTO_TCP){if(DATARMNETc03b668e4c)DATARMNET9250714999(DATARMNET543491eb0f);
return-EINVAL;}}else if(DATARMNET543491eb0f->protocol==htons(ETH_P_IPV6)){struct
 ipv6hdr*DATARMNETbf55123e5b,DATARMNETcf1d9e2c1e;int DATARMNET611d08d671;__be16 
DATARMNET98fed39916;u8 DATARMNET65293f17c4;DATARMNETbf55123e5b=
skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),sizeof(*
DATARMNETbf55123e5b),&DATARMNETcf1d9e2c1e);if(!DATARMNETbf55123e5b)return-EINVAL
;DATARMNET65293f17c4=DATARMNETbf55123e5b->nexthdr;DATARMNET611d08d671=
ipv6_skip_exthdr(DATARMNET543491eb0f,sizeof(*DATARMNETbf55123e5b),&
DATARMNET65293f17c4,&DATARMNET98fed39916);if(DATARMNET611d08d671<
(0xd2d+202-0xdf7)||DATARMNET98fed39916)return-EINVAL;if(DATARMNET65293f17c4==
IPPROTO_UDP){if(DATARMNET21c7a3c377)DATARMNET2a6d02a6a5(DATARMNET543491eb0f);
return DATARMNETee9214ce9b(DATARMNET543491eb0f,DATARMNET611d08d671);}if(
DATARMNET65293f17c4==IPPROTO_TCP){if(DATARMNETc03b668e4c)DATARMNET9250714999(
DATARMNET543491eb0f);return-EINVAL;}}return-EINVAL;}void DATARMNET7b0253229f(
struct sk_buff*DATARMNET543491eb0f){if(DATARMNET543491eb0f->protocol==htons(
ETH_P_IP)){struct iphdr*DATARMNET86f1f2cdc9,DATARMNETbf6548198e;
DATARMNET86f1f2cdc9=skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),
sizeof(*DATARMNET86f1f2cdc9),&DATARMNETbf6548198e);if(!DATARMNET86f1f2cdc9||
ip_is_fragment(DATARMNET86f1f2cdc9))return;if(DATARMNET86f1f2cdc9->protocol==
IPPROTO_TCP){if(DATARMNETc03b668e4c)DATARMNETd8fdde8978(DATARMNET543491eb0f);}}
else if(DATARMNET543491eb0f->protocol==htons(ETH_P_IPV6)){struct ipv6hdr*
DATARMNETbf55123e5b,DATARMNETcf1d9e2c1e;int DATARMNET611d08d671;__be16 
DATARMNET98fed39916;u8 DATARMNET65293f17c4;DATARMNETbf55123e5b=
skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),sizeof(*
DATARMNETbf55123e5b),&DATARMNETcf1d9e2c1e);if(!DATARMNETbf55123e5b)return;
DATARMNET65293f17c4=DATARMNETbf55123e5b->nexthdr;DATARMNET611d08d671=
ipv6_skip_exthdr(DATARMNET543491eb0f,sizeof(*DATARMNETbf55123e5b),&
DATARMNET65293f17c4,&DATARMNET98fed39916);if(DATARMNET611d08d671<
(0xd2d+202-0xdf7)||DATARMNET98fed39916)return;if(DATARMNET65293f17c4==
IPPROTO_TCP){if(DATARMNETc03b668e4c)DATARMNETd8fdde8978(DATARMNET543491eb0f);}}}
static void DATARMNET05c4bf8af9(struct sk_buff*DATARMNET543491eb0f,int 
DATARMNET611d08d671){if(DATARMNET77ab42949f(DATARMNET543491eb0f,
DATARMNET611d08d671))DATARMNET543491eb0f->priority=14286874;}void 
DATARMNET324fe25dad(struct sk_buff*DATARMNET543491eb0f){if(DATARMNET543491eb0f->
protocol==htons(ETH_P_IP)){struct iphdr*DATARMNET86f1f2cdc9,DATARMNETbf6548198e;
DATARMNET86f1f2cdc9=skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),
sizeof(*DATARMNET86f1f2cdc9),&DATARMNETbf6548198e);if(!DATARMNET86f1f2cdc9||
ip_is_fragment(DATARMNET86f1f2cdc9))return;if(DATARMNET86f1f2cdc9->protocol==
IPPROTO_UDP){if(DATARMNET21c7a3c377)DATARMNET5ecc30669c(DATARMNET543491eb0f);
DATARMNET05c4bf8af9(DATARMNET543491eb0f,DATARMNET86f1f2cdc9->ihl*
(0xd11+230-0xdf3));return;}if(DATARMNET86f1f2cdc9->protocol==IPPROTO_TCP){if(
DATARMNETc03b668e4c)DATARMNET9d574e64b1(DATARMNET543491eb0f);return;}}else if(
DATARMNET543491eb0f->protocol==htons(ETH_P_IPV6)){struct ipv6hdr*
DATARMNETbf55123e5b,DATARMNETcf1d9e2c1e;int DATARMNET611d08d671;__be16 
DATARMNET98fed39916;u8 DATARMNET65293f17c4;DATARMNETbf55123e5b=
skb_header_pointer(DATARMNET543491eb0f,(0xd2d+202-0xdf7),sizeof(*
DATARMNETbf55123e5b),&DATARMNETcf1d9e2c1e);if(!DATARMNETbf55123e5b)return;
DATARMNET65293f17c4=DATARMNETbf55123e5b->nexthdr;DATARMNET611d08d671=
ipv6_skip_exthdr(DATARMNET543491eb0f,sizeof(*DATARMNETbf55123e5b),&
DATARMNET65293f17c4,&DATARMNET98fed39916);if(DATARMNET611d08d671<
(0xd2d+202-0xdf7)||DATARMNET98fed39916)return;if(DATARMNET65293f17c4==
IPPROTO_UDP){if(DATARMNET21c7a3c377)DATARMNET5ecc30669c(DATARMNET543491eb0f);
DATARMNET05c4bf8af9(DATARMNET543491eb0f,DATARMNET611d08d671);return;}if(
DATARMNET65293f17c4==IPPROTO_TCP){if(DATARMNETc03b668e4c)DATARMNET9d574e64b1(
DATARMNET543491eb0f);return;}}}void DATARMNET21f4abc439(struct sk_buff*
DATARMNET543491eb0f);void DATARMNETa7918f2abb(struct sk_buff*DATARMNET543491eb0f
){if(skb_linearize(DATARMNET543491eb0f)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x4c\x69\x6e\x65\x61\x72\x69\x7a\x61\x74\x69\x6f\x6e\x20\x65\x72\x72\x6f\x72" "\n"
,__func__);return;}DATARMNET21f4abc439(DATARMNET543491eb0f);}void 
DATARMNET941e2135b0(uint8_t mux_id,uint32_t DATARMNET6f031e7934){if(!mux_id||
mux_id>(0xeb7+1158-0x132d))goto DATARMNET27d4697979;switch(DATARMNET6f031e7934){
case(0xd2d+202-0xdf7):DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.
DATARMNETcd826f85c1.DATARMNET09a124a6d5++;break;case(0xd26+209-0xdf6):
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETcd826f85c1.
DATARMNET9447586660++;break;case(0xd1f+216-0xdf5):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETcd826f85c1.DATARMNET3507da0e2a++;break;case
(0xd18+223-0xdf4):DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.
DATARMNETcd826f85c1.DATARMNETa510b8513c++;break;case(0xd11+230-0xdf3):
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETcd826f85c1.
DATARMNET34fcb79334++;break;case(0xd0a+237-0xdf2):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETcd826f85c1.DATARMNETda64236809++;break;case
(0xd03+244-0xdf1):DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.
DATARMNETcd826f85c1.DATARMNETe6327165c4++;break;case(0xcfc+267-0xe00):
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETcd826f85c1.
DATARMNET9dbda9c770++;break;case(0xd35+210-0xdff):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETcd826f85c1.DATARMNETaa87614a96++;break;case 9:
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETcd826f85c1.
DATARMNET232a43aa2e++;break;case(0xd27+224-0xdfd):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETcd826f85c1.DATARMNET914ce4d7bc++;break;default:
break;}DATARMNET27d4697979:return;}void DATARMNETe6269dcf2c(uint8_t mux_id,
uint8_t DATARMNETb2211e57d2,uint64_t len,uint32_t DATARMNET6f031e7934){if(!
mux_id||mux_id>(0xeb7+1158-0x132d))goto DATARMNET27d4697979;if(
DATARMNETb2211e57d2>=(0xeb7+1158-0x132d))goto DATARMNET27d4697979;switch(
DATARMNET6f031e7934){case(0xd2d+202-0xdf7):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETc5ec22d8f4[DATARMNETb2211e57d2].DATARMNET209094b7dd
++;DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETc5ec22d8f4[
DATARMNETb2211e57d2].DATARMNETfdd32eb79e+=len;break;case(0xd26+209-0xdf6):
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETc5ec22d8f4[
DATARMNETb2211e57d2].DATARMNET6c81844df0++;DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETc5ec22d8f4[DATARMNETb2211e57d2].DATARMNET462c6e2ad3
+=len;break;case(0xd1f+216-0xdf5):DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETc5ec22d8f4[DATARMNETb2211e57d2].DATARMNET8409399739
++;DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETc5ec22d8f4[
DATARMNETb2211e57d2].DATARMNETcb286ca3be+=len;break;case(0xd18+223-0xdf4):
DATARMNETceb52e7075[mux_id].DATARMNETbe4615133d.DATARMNETc5ec22d8f4[
DATARMNETb2211e57d2].DATARMNET2698e2274b++;DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNETc5ec22d8f4[DATARMNETb2211e57d2].DATARMNET29b53445ac
+=len;break;}DATARMNET27d4697979:return;}void DATARMNETc70b241863(uint8_t mux_id
,struct sk_buff*DATARMNET543491eb0f){if(!mux_id||mux_id>(0xeb7+1158-0x132d))goto
 DATARMNET27d4697979;if(DATARMNET543491eb0f->protocol==htons(ETH_P_IP)){if(
ip_hdr(DATARMNET543491eb0f)->protocol==IPPROTO_TCP){DATARMNETceb52e7075[mux_id].
DATARMNET0b3510b126.DATARMNET0e6c4cf04c.DATARMNET209094b7dd++;
DATARMNETceb52e7075[mux_id].DATARMNET0b3510b126.DATARMNET0e6c4cf04c.
DATARMNETfdd32eb79e+=DATARMNET543491eb0f->len;}else if(ip_hdr(
DATARMNET543491eb0f)->protocol==IPPROTO_UDP){DATARMNETceb52e7075[mux_id].
DATARMNET0b3510b126.DATARMNET0e6c4cf04c.DATARMNET6c81844df0++;
DATARMNETceb52e7075[mux_id].DATARMNET0b3510b126.DATARMNET0e6c4cf04c.
DATARMNET462c6e2ad3+=DATARMNET543491eb0f->len;}}if(DATARMNET543491eb0f->protocol
==htons(ETH_P_IPV6)){if(ipv6_hdr(DATARMNET543491eb0f)->nexthdr==IPPROTO_TCP){
DATARMNETceb52e7075[mux_id].DATARMNET0b3510b126.DATARMNET0e6c4cf04c.
DATARMNET8409399739++;DATARMNETceb52e7075[mux_id].DATARMNET0b3510b126.
DATARMNET0e6c4cf04c.DATARMNETcb286ca3be+=DATARMNET543491eb0f->len;}else if(
ipv6_hdr(DATARMNET543491eb0f)->nexthdr==IPPROTO_UDP){DATARMNETceb52e7075[mux_id]
.DATARMNET0b3510b126.DATARMNET0e6c4cf04c.DATARMNET2698e2274b++;
DATARMNETceb52e7075[mux_id].DATARMNET0b3510b126.DATARMNET0e6c4cf04c.
DATARMNET29b53445ac+=DATARMNET543491eb0f->len;}}DATARMNET27d4697979:return;}void
 DATARMNETc892e451fe(uint8_t mux_id,uint64_t len){if(!mux_id||mux_id>
(0xeb7+1158-0x132d))goto DATARMNET27d4697979;DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNET11724e6fbe++;DATARMNETceb52e7075[mux_id].
DATARMNETbe4615133d.DATARMNET3e28742e7a+=len;DATARMNET27d4697979:return;}static 
const struct rmnet_module_hook_register_info DATARMNET95a71e03c1[]={{.hooknum=
RMNET_MODULE_HOOK_PERF_INGRESS,.func=DATARMNETf2958615b1,},{.hooknum=
RMNET_MODULE_HOOK_PERF_EGRESS,.func=DATARMNET324fe25dad,},{.hooknum=
RMNET_MODULE_HOOK_PERF_SET_THRESH,.func=DATARMNET7fa1835595,},{.hooknum=
RMNET_MODULE_HOOK_PERF_INGRESS_RX_HANDLER,.func=DATARMNET7b0253229f,},{.hooknum=
RMNET_MODULE_HOOK_PERF_CMD_INGRESS,.func=DATARMNETa7918f2abb,},{.hooknum=
RMNET_MODULE_HOOK_PERF_COAL_COMMON_STAT,.func=DATARMNET941e2135b0,},{.hooknum=
RMNET_MODULE_HOOK_PERF_COAL_STAT,.func=DATARMNETe6269dcf2c,},{.hooknum=
RMNET_MODULE_HOOK_PERF_SEG_STAT,.func=DATARMNETc70b241863,},{.hooknum=
RMNET_MODULE_HOOK_PERF_NON_COAL_STAT,.func=DATARMNETc892e451fe,},};void 
DATARMNET49c17a32bc(void){rmnet_module_hook_register(DATARMNET95a71e03c1,
ARRAY_SIZE(DATARMNET95a71e03c1));}void DATARMNET41e8cc085c(void){
rmnet_module_hook_unregister(DATARMNET95a71e03c1,ARRAY_SIZE(DATARMNET95a71e03c1)
);}int DATARMNET0b2c5bc768(struct sk_buff*DATARMNET543491eb0f,struct genl_info*
DATARMNET54338da2ff);int DATARMNET114b9148d9(struct sk_buff*DATARMNET543491eb0f,
struct genl_info*DATARMNET54338da2ff);static const struct genl_ops 
DATARMNET1cf1a695d4[]={{.cmd=DATARMNET9420caeb53,.doit=DATARMNET0b2c5bc768,},{.
cmd=DATARMNET036a8433e0,.doit=DATARMNET114b9148d9,},};struct genl_family 
DATARMNETe64f65b66c __ro_after_init={.hdrsize=(0xd2d+202-0xdf7),.name=
DATARMNETa83100182f,.version=DATARMNET816321eafb,.maxattr=DATARMNETed4efa075c,.
policy=DATARMNET9e2a491680,.ops=DATARMNET1cf1a695d4,.n_ops=ARRAY_SIZE(
DATARMNET1cf1a695d4),.mcgrps=DATARMNET4e83edd544,.n_mcgrps=ARRAY_SIZE(
DATARMNET4e83edd544),};int DATARMNET0b2c5bc768(struct sk_buff*
DATARMNET543491eb0f,struct genl_info*DATARMNET54338da2ff){struct 
DATARMNETf723c861fa*DATARMNETa13fcf9070=NULL;struct DATARMNETf698794b6c 
DATARMNETddcafd8b91;int DATARMNET4989d95877=-(0xd26+209-0xdf6),
DATARMNET61c2303133=-ENOMEM;struct sk_buff*DATARMNETfb7a00623a=NULL;struct 
nlattr*DATARMNET9c5e00ef03=NULL;void*DATARMNET1ed9689f7e=NULL;
DATARMNETfb7a00623a=genlmsg_new(NLMSG_GOODSIZE,GFP_ATOMIC);if(!
DATARMNETfb7a00623a){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x73\x6b\x62" "\n"
,__func__);goto DATARMNET27d4697979;}DATARMNET1ed9689f7e=genlmsg_put(
DATARMNETfb7a00623a,(0xd2d+202-0xdf7),DATARMNET376884db81++,&DATARMNETe64f65b66c
,(0xd2d+202-0xdf7),DATARMNET9420caeb53);if(!DATARMNET1ed9689f7e){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x73\x65\x74\x20\x68\x65\x61\x64\x65\x72\x20\x70\x6f\x69\x6e\x74\x65\x72" "\n"
,__func__);goto DATARMNETb042feb7e2;}DATARMNETa13fcf9070=kzalloc(sizeof(struct 
DATARMNETf723c861fa),GFP_ATOMIC);if(!DATARMNETa13fcf9070){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x63\x6d\x64" "\n"
,__func__);goto DATARMNETb042feb7e2;}memset(&DATARMNETddcafd8b91,
(0xd2d+202-0xdf7),sizeof(struct DATARMNETf698794b6c));DATARMNET61c2303133=-
EINVAL;DATARMNET9c5e00ef03=DATARMNET54338da2ff->attrs[DATARMNET3b1665bc33];if(!
DATARMNET9c5e00ef03){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x63\x6d\x64\x20\x72\x65\x71\x75\x65\x73\x74\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);goto DATARMNET321a78afb9;}DATARMNET4989d95877=nla_memcpy(&
DATARMNETddcafd8b91,DATARMNET9c5e00ef03,sizeof(struct DATARMNETf698794b6c));if(
DATARMNET4989d95877<=(0xd2d+202-0xdf7)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x70\x79\x20\x63\x6d\x64\x20\x72\x65\x71\x75\x65\x73\x74\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);goto DATARMNET321a78afb9;}if(DATARMNETddcafd8b91.mux_id>
(0xeb7+1158-0x132d)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x6d\x75\x78\x20\x69\x64\x20\x25\x75" "\n"
,__func__,DATARMNETddcafd8b91.mux_id);goto DATARMNET321a78afb9;}
DATARMNET61c2303133=(0xd2d+202-0xdf7);memcpy(&DATARMNETa13fcf9070->
DATARMNETa57ae53d4c,&DATARMNETceb52e7075[DATARMNETddcafd8b91.mux_id],sizeof(
struct DATARMNETce5df1988e));DATARMNET321a78afb9:DATARMNETa13fcf9070->
DATARMNETfdf7997f18=abs(DATARMNET61c2303133);if(!nla_put(DATARMNETfb7a00623a,
DATARMNETf5c6d9329e,sizeof(struct DATARMNETf723c861fa),DATARMNETa13fcf9070)){
kfree(DATARMNETa13fcf9070);genlmsg_end(DATARMNETfb7a00623a,DATARMNET1ed9689f7e);
return genlmsg_reply(DATARMNETfb7a00623a,DATARMNET54338da2ff);}else{pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x70\x79\x20\x63\x6d\x64\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);}kfree(DATARMNETa13fcf9070);DATARMNETb042feb7e2:nlmsg_free(
DATARMNETfb7a00623a);DATARMNET27d4697979:return DATARMNET61c2303133;}void 
DATARMNET21f4abc439(struct sk_buff*DATARMNET543491eb0f){uint8_t 
DATARMNETb65c469a15=sizeof(struct qmap_cmd_hdr);struct DATARMNET0276dc600a*
DATARMNET3be93329cd=NULL;struct qmap_cmd_hdr*DATARMNET8b1565b348=NULL;struct 
sk_buff*DATARMNET1bd2c6f90a=NULL;void*DATARMNET1ed9689f7e=NULL;int 
DATARMNETb14e52a504=-EINVAL;DATARMNET1bd2c6f90a=genlmsg_new(NLMSG_GOODSIZE,
GFP_ATOMIC);if(!DATARMNET1bd2c6f90a){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x69\x6e\x64\x69\x63\x61\x74\x69\x6f\x6e\x20\x73\x6b\x62" "\n"
,__func__);goto DATARMNET27d4697979;}DATARMNET1ed9689f7e=genlmsg_put(
DATARMNET1bd2c6f90a,(0xd2d+202-0xdf7),DATARMNET376884db81++,&DATARMNETe64f65b66c
,(0xd2d+202-0xdf7),DATARMNET036a8433e0);if(!DATARMNET1ed9689f7e){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x73\x65\x74\x20\x68\x65\x61\x64\x65\x72\x20\x70\x6f\x69\x6e\x74\x65\x72" "\n"
,__func__);goto DATARMNETb042feb7e2;}DATARMNET3be93329cd=kzalloc(sizeof(struct 
DATARMNET0276dc600a),GFP_ATOMIC);if(!DATARMNET3be93329cd){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x69\x6e\x64\x69\x63\x61\x74\x69\x6f\x6e\x20\x63\x6d\x64" "\n"
,__func__);goto DATARMNETb042feb7e2;}if(DATARMNET543491eb0f->len<=
DATARMNETb65c469a15){pr_err(
"\x25\x73\x28\x29\x3a\x20\x49\x6e\x63\x6f\x6d\x69\x6e\x67\x20\x63\x6d\x64\x20\x73\x69\x7a\x65\x20\x69\x73\x20\x69\x6e\x76\x61\x6c\x69\x64" "\n"
,__func__);goto DATARMNET321a78afb9;}DATARMNET8b1565b348=(struct qmap_cmd_hdr*)
DATARMNET543491eb0f->data;DATARMNET3be93329cd->DATARMNETaab62d18d0=
DATARMNET543491eb0f->len-DATARMNETb65c469a15;DATARMNET3be93329cd->cmd_name=
DATARMNET8b1565b348->cmd_name;DATARMNET3be93329cd->ack=DATARMNET8b1565b348->
cmd_type;memcpy(DATARMNET3be93329cd->DATARMNET7dcd62530f,DATARMNET543491eb0f->
data+DATARMNETb65c469a15,DATARMNET3be93329cd->DATARMNETaab62d18d0);if(nla_put(
DATARMNET1bd2c6f90a,DATARMNET5b232a76af,sizeof(struct DATARMNET0276dc600a),
DATARMNET3be93329cd)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x70\x79\x20\x63\x6d\x64\x20\x69\x6e\x64\x69\x63\x61\x74\x69\x6f\x6e\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);goto DATARMNET321a78afb9;}genlmsg_end(DATARMNET1bd2c6f90a,
DATARMNET1ed9689f7e);kfree(DATARMNET3be93329cd);DATARMNETb14e52a504=
genlmsg_multicast(&DATARMNETe64f65b66c,DATARMNET1bd2c6f90a,(0xd2d+202-0xdf7),
DATARMNET055fcd05b3,GFP_ATOMIC);if(DATARMNETb14e52a504==-EINVAL){pr_err(
"\x25\x73\x28\x29\x3a\x20\x49\x6e\x76\x61\x6c\x69\x64\x20\x67\x72\x6f\x75\x70\x20\x66\x6f\x72\x20\x6d\x75\x6c\x74\x69\x63\x61\x73\x74" "\n"
,__func__);goto DATARMNETb042feb7e2;}return;DATARMNET321a78afb9:kfree(
DATARMNET3be93329cd);DATARMNETb042feb7e2:nlmsg_free(DATARMNET1bd2c6f90a);
DATARMNET27d4697979:return;}int DATARMNETaee3327083(struct DATARMNETec7dafaa2f*
cmd){struct net_device*dev=dev_get_by_name(&init_net,
"\x72\x6d\x6e\x65\x74\x5f\x69\x70\x61\x30");int DATARMNETaab62d18d0=sizeof(
struct qmap_cmd_hdr)+cmd->DATARMNETaab62d18d0;struct qmap_cmd_hdr*
DATARMNET8b1565b348=NULL;struct sk_buff*DATARMNET543491eb0f=NULL;char*
DATARMNET7dcd62530f=NULL;int DATARMNET61c2303133=-ENODEV;if(!dev){pr_err(
"\x25\x73\x28\x29\x3a\x20\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x67\x65\x74\x20\x72\x65\x66\x65\x72\x65\x6e\x63\x65\x20\x74\x6f\x20\x64\x65\x76\x69\x63\x65" "\n"
,__func__);goto DATARMNET27d4697979;}DATARMNET543491eb0f=alloc_skb(
DATARMNETaab62d18d0,GFP_ATOMIC);if(!DATARMNET543491eb0f){pr_err(
"\x25\x73\x28\x29\x3a\x20\x55\x6e\x61\x62\x6c\x65\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x6d\x65\x6d\x6f\x72\x79\x20\x66\x6f\x72\x20\x63\x6d\x64" "\n"
,__func__);DATARMNET61c2303133=-ENOMEM;goto DATARMNETb042feb7e2;}skb_put(
DATARMNET543491eb0f,DATARMNETaab62d18d0);memset(DATARMNET543491eb0f->data,
(0xd2d+202-0xdf7),DATARMNETaab62d18d0);DATARMNET8b1565b348=(struct qmap_cmd_hdr*
)DATARMNET543491eb0f->data;DATARMNET8b1565b348->cd_bit=(0xd26+209-0xdf6);
DATARMNET8b1565b348->mux_id=(0xd2d+202-0xdf7);DATARMNET8b1565b348->pkt_len=htons
(sizeof(struct rmnet_map_control_command_header)+cmd->DATARMNETaab62d18d0);
DATARMNET8b1565b348->cmd_name=cmd->cmd_name;DATARMNET8b1565b348->cmd_type=cmd->
ack;DATARMNET7dcd62530f=(char*)(DATARMNET543491eb0f->data+sizeof(struct 
qmap_cmd_hdr));memcpy(DATARMNET7dcd62530f,cmd->DATARMNET7dcd62530f,cmd->
DATARMNETaab62d18d0);DATARMNET543491eb0f->dev=dev;DATARMNET543491eb0f->protocol=
htons(ETH_P_MAP);DATARMNET61c2303133=rmnet_qmap_send(DATARMNET543491eb0f,
RMNET_CH_CTL,false);DATARMNETb042feb7e2:dev_put(dev);DATARMNET27d4697979:return 
DATARMNET61c2303133;}int DATARMNET114b9148d9(struct sk_buff*DATARMNET543491eb0f,
struct genl_info*DATARMNET54338da2ff){struct DATARMNETec7dafaa2f*
DATARMNETddcafd8b91=NULL;struct DATARMNETa312f70a7c DATARMNETa13fcf9070;int 
DATARMNET4989d95877=-(0xd26+209-0xdf6),DATARMNET61c2303133=-ENOMEM;struct 
sk_buff*DATARMNETfb7a00623a=NULL;struct nlattr*DATARMNET9c5e00ef03=NULL;void*
DATARMNET1ed9689f7e=NULL;DATARMNETfb7a00623a=genlmsg_new(NLMSG_GOODSIZE,
GFP_ATOMIC);if(!DATARMNETfb7a00623a){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x73\x6b\x62" "\n"
,__func__);goto DATARMNET27d4697979;}DATARMNET1ed9689f7e=genlmsg_put(
DATARMNETfb7a00623a,(0xd2d+202-0xdf7),DATARMNET376884db81++,&DATARMNETe64f65b66c
,(0xd2d+202-0xdf7),DATARMNET036a8433e0);if(!DATARMNET1ed9689f7e){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x73\x65\x74\x20\x68\x65\x61\x64\x65\x72\x20\x70\x6f\x69\x6e\x74\x65\x72" "\n"
,__func__);goto DATARMNETb042feb7e2;}memset(&DATARMNETa13fcf9070,
(0xd2d+202-0xdf7),sizeof(struct DATARMNETa312f70a7c));DATARMNETddcafd8b91=
kzalloc(sizeof(struct DATARMNETec7dafaa2f),GFP_ATOMIC);if(!DATARMNETddcafd8b91){
pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x61\x6c\x6c\x6f\x63\x61\x74\x65\x20\x72\x65\x71\x75\x65\x73\x74\x20\x63\x6d\x64" "\n"
,__func__);goto DATARMNET321a78afb9;}DATARMNET61c2303133=-EINVAL;
DATARMNET9c5e00ef03=DATARMNET54338da2ff->attrs[DATARMNET951a42c086];if(!
DATARMNET9c5e00ef03){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x67\x65\x74\x20\x63\x6d\x64\x20\x72\x65\x71\x75\x65\x73\x74\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);goto DATARMNET55f99d18f5;}DATARMNET4989d95877=nla_memcpy(
DATARMNETddcafd8b91,DATARMNET9c5e00ef03,sizeof(struct DATARMNETec7dafaa2f));if(
DATARMNET4989d95877<=(0xd2d+202-0xdf7)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x70\x79\x20\x63\x6d\x64\x20\x72\x65\x71\x75\x65\x73\x74\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);goto DATARMNET55f99d18f5;}switch(DATARMNETddcafd8b91->cmd_name){case 
QMAP_CMD_31:case QMAP_CMD_32:case QMAP_CMD_40:case QMAP_CMD_42:break;default:
pr_err(
"\x25\x73\x28\x29\x3a\x20\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x63\x6f\x6d\x6d\x61\x6e\x64\x20\x25\x75" "\n"
,__func__,DATARMNETddcafd8b91->cmd_name);goto DATARMNET55f99d18f5;}if(!
DATARMNETddcafd8b91->DATARMNETaab62d18d0||(DATARMNETddcafd8b91->
DATARMNETaab62d18d0>16000)){pr_err(
"\x25\x73\x28\x29\x3a\x20\x55\x6e\x73\x75\x70\x70\x6f\x72\x74\x65\x64\x20\x6c\x65\x6e\x67\x74\x68\x20\x25\x75" "\n"
,__func__,DATARMNETddcafd8b91->DATARMNETaab62d18d0);goto DATARMNET55f99d18f5;}
DATARMNETa13fcf9070.cmd_name=DATARMNETddcafd8b91->cmd_name;DATARMNET61c2303133=
DATARMNETaee3327083(DATARMNETddcafd8b91);DATARMNET55f99d18f5:kfree(
DATARMNETddcafd8b91);DATARMNET321a78afb9:DATARMNETa13fcf9070.DATARMNETfdf7997f18
=abs(DATARMNET61c2303133);if(!nla_put(DATARMNETfb7a00623a,DATARMNET246991e0bf,
sizeof(struct DATARMNETa312f70a7c),&DATARMNETa13fcf9070)){genlmsg_end(
DATARMNETfb7a00623a,DATARMNET1ed9689f7e);return genlmsg_reply(
DATARMNETfb7a00623a,DATARMNET54338da2ff);}else{pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x63\x6f\x70\x79\x20\x63\x6d\x64\x20\x72\x65\x73\x70\x6f\x6e\x73\x65\x20\x61\x74\x74\x72\x69\x62\x75\x74\x65" "\n"
,__func__);}DATARMNETb042feb7e2:nlmsg_free(DATARMNETfb7a00623a);
DATARMNET27d4697979:return DATARMNET61c2303133;}int DATARMNET31ff8cdc40(void){
return genl_register_family(&DATARMNETe64f65b66c);}void DATARMNET8e1548cd2e(void
){genl_unregister_family(&DATARMNETe64f65b66c);}static int __init 
DATARMNET63abbdc3d3(void){int DATARMNETb14e52a504;pr_info(
"\x25\x73\x28\x29\x3a\x20\x4c\x6f\x61\x64\x69\x6e\x67" "\n",__func__);
DATARMNETb14e52a504=DATARMNET7e9995246e();if(DATARMNETb14e52a504)goto 
DATARMNET27d4697979;DATARMNETb14e52a504=DATARMNETe80a33d544();if(
DATARMNETb14e52a504)goto DATARMNETb042feb7e2;DATARMNETb14e52a504=
DATARMNET31ff8cdc40();if(DATARMNETb14e52a504){pr_err(
"\x25\x73\x28\x29\x3a\x20\x46\x61\x69\x6c\x65\x64\x20\x74\x6f\x20\x72\x65\x67\x69\x73\x74\x65\x72\x20\x67\x65\x6e\x65\x72\x69\x63\x20\x6e\x65\x74\x6c\x69\x6e\x6b\x20\x66\x61\x6d\x69\x6c\x79" "\n"
,__func__);goto DATARMNET321a78afb9;}DATARMNET49c17a32bc();DATARMNET321a78afb9:
DATARMNET4b5170a1ef();DATARMNETb042feb7e2:DATARMNET38bb6f2b7a();
DATARMNET27d4697979:return DATARMNETb14e52a504;}static void __exit 
DATARMNETa343229e33(void){DATARMNET41e8cc085c();DATARMNET8e1548cd2e();
DATARMNET4b5170a1ef();DATARMNET38bb6f2b7a();pr_info(
"\x25\x73\x28\x29\x3a\x20\x65\x78\x69\x74\x69\x6e\x67" "\n",__func__);}
module_init(DATARMNET63abbdc3d3);module_exit(DATARMNETa343229e33);

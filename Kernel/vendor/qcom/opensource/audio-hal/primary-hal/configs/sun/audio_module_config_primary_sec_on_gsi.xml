<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
Copyright (c) 2023-2024 Qualcomm Innovation Center, Inc. All rights reserved.
SPDX-License-Identifier: BSD-3-Clause-Clear
-->
<modules>
<module name="default">
    <mixPorts>
        <!-- based on role, mixport flags are identified as either input flags or
        output flags-->
        <!-- start of source mixports-->
        <mixPort name="primary_out" role="source" flags="PRIMARY">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="deep_buffer" role="source" flags="DEEP_BUFFER">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="FIXED_Q_8_24" />
        </mixPort>
        <mixPort name="fast" role="source" flags="FAST">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="raw" role="source" flags="FAST RAW">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="haptic" role="source">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO_HAPTIC_A" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="mmap_no_irq_out" role="source" flags="DIRECT MMAP_NOIRQ">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="FIXED_Q_8_24" />
        </mixPort>
        <mixPort name="hifi_playback" role="source">
        </mixPort>
        <mixPort name="direct_pcm" role="source" flags="DIRECT" recommendedMuteDurationMs="160">
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="INT_16_BIT" />
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="FIXED_Q_8_24" />
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="INT_24_BIT" />
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="INT_32_BIT" />
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="FLOAT_32_BIT" />
        </mixPort>
        <mixPort name="compressed_offload" role="source" recommendedMuteDurationMs="190" flags="DIRECT COMPRESS_OFFLOAD NON_BLOCKING GAPLESS_OFFLOAD">
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/mpeg" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/flac" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/mp4a.40.02" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/mp4a.40.05" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/mp4a.40.29" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/aac-adts.02" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/aac-adts.05" />
            <profile samplingRates="11025 16000 22050 32000 44100 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/aac-adts.29" />
            <profile samplingRates="8000 12000 16000 24000 48000" channelLayouts="LAYOUT_STEREO LAYOUT_MONO" formatType="NON_PCM" encoding="audio/opus" />
        </mixPort>
        <mixPort name="voice_tx" role="source">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="voip_rx" role="source" flags="VOIP_RX">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="incall_music_uplink" role="source" flags="INCALL_MUSIC">
            <profile samplingRates="8000 16000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <!-- end of source mixports-->

        <!-- start of sink mixports-->
        <mixPort name="primary input" role="sink" maxOpenCount="2" maxActiveCount="2">
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_FRONT_BACK LAYOUT_2POINT0POINT2" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="voice_rx" role="sink">
            <profile samplingRates="8000 16000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="voip_tx" role="sink" flags="VOIP_TX">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_MONO"
                formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="mmap_no_irq_in" role="sink" maxOpenCount="1" maxActiveCount="1" flags="MMAP_NOIRQ">
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_FRONT_BACK" channelMasks="INDEX_MASK_3" formatType="PCM" pcmType="INT_16_BIT" />
        </mixPort>
        <mixPort name="hifi_input" role="sink" />
        <!-- end of sink mixports-->
    </mixPorts>
    <devicePorts>
        <!-- start of sink DEVICE PORT -->
        <devicePort tagName="Earpiece" role="sink" attached="true" deviceType="OUT_SPEAKER_EARPIECE">
            <profile samplingRates="48000" channelLayouts="LAYOUT_MONO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="Speaker" role="sink" attached="true" defaultDevice="true" deviceType="OUT_SPEAKER">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT SCO" deviceType="OUT_DEVICE" connection="bt-sco" role="sink">
            <profile samplingRates="8000 48000" channelLayouts="LAYOUT_MONO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT SCO Headset" deviceType="OUT_HEADSET" connection="bt-sco" role="sink">
            <profile samplingRates="8000 16000" channelLayouts="LAYOUT_MONO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT SCO Car Kit" deviceType="OUT_CARKIT" connection="bt-sco" role="sink">
            <profile samplingRates="8000 16000" channelLayouts="LAYOUT_MONO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="Telephony Tx" deviceType="OUT_TELEPHONY_TX" role="sink" attached="true">
            <profile samplingRates="8000 16000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <!-- Todo check the sanity of below later w.r.t channel layouts -->
        <devicePort tagName="HDMI" deviceType="OUT_DEVICE" connection="hdmi" role="sink">
            <profile samplingRates="44100 48000 64000 88200 96000 128000 176400 192000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_2POINT1 LAYOUT_QUAD LAYOUT_PENTA LAYOUT_5POINT1 LAYOUT_6POINT1 LAYOUT_7POINT1" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT A2DP Out" deviceType="OUT_DEVICE" connection="bt-a2dp" role="sink">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT A2DP Headphones" deviceType="OUT_HEADPHONE" connection="bt-a2dp" role="sink">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT A2DP Speaker" deviceType="OUT_SPEAKER" connection="bt-a2dp" role="sink">
            <profile samplingRates="48000" channelLayouts="LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT BLE Out" deviceType="OUT_HEADSET" connection="bt-le" role="sink">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT BLE Speaker" deviceType="OUT_SPEAKER" connection="bt-le" role="sink">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT BLE Broadcast" deviceType="OUT_BROADCAST" connection="bt-le" role="sink" encodings="audio/x-lc3">
            <profile samplingRates="8000 16000 32000 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="USB Device Out" deviceType="OUT_DEVICE" connection="usb" role="sink"/>
        <devicePort tagName="USB Headset Out" deviceType="OUT_HEADSET" connection="usb" role="sink"/>
        <!-- end of sink DEVICE PORT -->

        <!-- start of source DEVICE PORT -->
        <devicePort tagName="Built-In Mic" deviceType="IN_MICROPHONE" role="source" attached="true" defaultDevice="true" address="bottom">
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_FRONT_BACK" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="Built-In Back Mic" deviceType="IN_MICROPHONE_BACK" role="source" attached="true" address="back">
            <profile samplingRates="8000 11025 12000 16000 22050 24000 32000 44100 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO LAYOUT_FRONT_BACK" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="FM Tuner" deviceType="IN_FM_TUNER" role="source" attached="true">
            <profile samplingRates="8000,11025,12000,16000,22050,24000,32000,44100,48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="BT SCO Headset Mic" deviceType="IN_HEADSET" connection="bt-sco" role="source">
            <profile samplingRates="8000 16000" channelLayouts="LAYOUT_MONO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="Telephony Rx" deviceType="IN_TELEPHONY_RX" role="source" attached="true">
            <profile samplingRates="8000,11025,12000,16000,22050,24000,32000,44100,48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <devicePort tagName="USB Device In" deviceType="IN_DEVICE" connection="usb" role="source" >
        </devicePort>
        <devicePort tagName="USB Headset In" deviceType="IN_HEADSET" connection="usb" role="source" >
        </devicePort>
        <devicePort tagName="BLE In" deviceType="IN_HEADSET" connection="bt-le" role="source">
            <profile samplingRates="8000 16000 24000 44100 48000" channelLayouts="LAYOUT_MONO LAYOUT_STEREO" formatType="PCM" pcmType="INT_16_BIT" />
        </devicePort>
        <!-- end of source DEVICE PORT -->
    </devicePorts>
    <routes>
        <route type="mix" sink="Earpiece" sources="primary_out,deep_buffer,fast,compressed_offload,voip_rx,mmap_no_irq_out,Telephony Rx" />
        <route type="mix" sink="Speaker" sources="primary_out,deep_buffer,fast,raw,compressed_offload,voip_rx,mmap_no_irq_out,haptic,Telephony Rx" />
        <route type="mix" sink="HDMI" sources="primary_out,deep_buffer,fast,raw,direct_pcm,compressed_offload,voip_rx" />

        <route type="mix" sink="BT SCO" sources="primary_out,deep_buffer,fast,raw,voip_rx,haptic,Telephony Rx"/>
        <route type="mix" sink="BT SCO Headset" sources="primary_out,deep_buffer,fast,raw,voip_rx,haptic,Telephony Rx"/>
        <route type="mix" sink="BT SCO Car Kit" sources="primary_out,deep_buffer,fast,raw,voip_rx,haptic,Telephony Rx"/>

        <route type="mix" sink="USB Device Out" sources="primary_out,deep_buffer,fast,raw,direct_pcm,compressed_offload,voip_rx,mmap_no_irq_out,hifi_playback,haptic,Telephony Rx"/>
        <route type="mix" sink="USB Headset Out" sources="primary_out,deep_buffer,fast,raw,direct_pcm,compressed_offload,voip_rx,mmap_no_irq_out,hifi_playback,haptic,Telephony Rx"/>

        <route type="mix" sink="BT A2DP Out" sources="primary_out,deep_buffer,fast,raw,compressed_offload,mmap_no_irq_out,haptic"/>
        <route type="mix" sink="BT A2DP Headphones" sources="primary_out,deep_buffer,fast,raw,compressed_offload,mmap_no_irq_out,haptic"/>
        <route type="mix" sink="BT A2DP Speaker" sources="primary_out,deep_buffer,fast,raw,compressed_offload,mmap_no_irq_out,haptic"/>

        <route type="mix" sink="BT BLE Out" sources="primary_out,deep_buffer,fast,raw,compressed_offload,voip_rx,mmap_no_irq_out,haptic,Telephony Rx"/>
        <route type="mix" sink="BT BLE Speaker" sources="primary_out,deep_buffer,fast,raw,compressed_offload,voip_rx,mmap_no_irq_out,haptic,Telephony Rx"/>
        <route type="mix" sink="BT BLE Broadcast" sources="primary_out,deep_buffer,fast,raw,compressed_offload"/>

        <route type="mix" sink="Telephony Tx" sources="voice_tx,incall_music_uplink,Built-In Mic,Built-In Back Mic,BT SCO Headset Mic,USB Device In,USB Headset In,BLE In"/>

        <route type="mix" sink="primary input" sources="Built-In Mic,Built-In Back Mic,BT SCO Headset Mic,FM Tuner,Aux Device In,USB Device In,USB Headset In,Telephony Rx,BLE In"/>
        <route type="mix" sink="voip_tx" sources="Built-In Mic,Built-In Back Mic,BT SCO Headset Mic,USB Device In,USB Headset In,BLE In"/>
        <route type="mix" sink="mmap_no_irq_in" sources="Built-In Mic,Built-In Back Mic,BT SCO Headset Mic,USB Device In,USB Headset In"/>
        <route type="mix" sink="hifi_input" sources="USB Device In,USB Headset In" />
        <route type="mix" sink="voice_rx" sources="Telephony Rx" />
    </routes>
</module>
</modules>
